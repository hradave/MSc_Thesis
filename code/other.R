library(pROC)
actual = sample(c(0,1), 84, replace = TRUE)
actual = sort(actual)

pred1 = actual
pred1[83] = 0
pred1[5] = 1

pred2 = pred1
pred2[82] = 0

pred3 = sample(c(0,1), 84, replace = TRUE)

pred[1:46] = pred[1:46] + abs(rnorm(46, mean = 0, sd = 0.1))
pred[47:100] = pred[47:100] - abs(rnorm(54, mean = 0, sd = 0.1))
pred[100] = 0.2

roc_curve1 = roc(actual, pred1, plot = TRUE)
roc_curve2 = roc(actual, pred2, plot = TRUE)
roc_curve3 = roc(actual, pred3, plot = TRUE)

ggroc(roc_curve)
roc_curve$auc

#compare pred1 and pred2
h = roc.test(roc_curve1, roc_curve3, method = "delong")
h


# small
slide_actual = c(rep(0,42),rep(1,42))

flip = c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0)
weighted = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1)
logreg = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
majvote = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1)
standard = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1)

# medium
majvote_m = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0)
weighted_m = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0)
logreg_m = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0)
flip_m = c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0)
standard_m = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0)

accuracy= function(a,b){
  return(sum(a==b)/length(a))
}

accuracy(slide_actual,flip)
accuracy(slide_actual,weighted)
accuracy(slide_actual,logreg)
accuracy(slide_actual,majvote)
accuracy(slide_actual,standard)

accuracy(slide_actual,flip_m)
accuracy(slide_actual,weighted_m)
accuracy(slide_actual,logreg_m)
accuracy(slide_actual,majvote_m)
accuracy(slide_actual,standard_m)



# accuracy plot
epochs = c(1:20)
val_acc_small = c(0.74141925573349, 0.7550765872001648, 0.7463809847831726, 0.7686839699745178, 0.7653495073318481, 0.769163191318512, 0.754787027835846, 0.769292950630188, 0.7687039375305176, 0.7573827505111694, 0.8435596823692322, 0.8503084778785706, 0.8720424175262451, 0.8651039004325867, 0.866431713104248, 0.875326931476593, 0.8698959946632385, 0.8718826770782471, 0.8770341277122498, 0.8787412643432617)
train_acc_small = c(0.8028098940849304, 0.8478521704673767, 0.8624858260154724, 0.87014240026474, 0.8760226368904114, 0.8796378374099731, 0.8822784423828125, 0.8844183087348938, 0.8853541612625122, 0.8871930837631226, 0.9057577848434448, 0.9652757048606873, 0.9768961668014526, 0.9822489023208618, 0.9856942296028137, 0.9879831671714783, 0.9904181361198425, 0.9915089011192322, 0.9926891326904297, 0.9936428666114807)
val_acc_medium = c(0.6808034777641296, 0.6842243671417236, 0.6943116784095764, 0.7047059535980225, 0.6987412571907043, 0.7033901810646057, 0.7094425559043884, 0.7032147645950317, 0.7169861197471619, 0.7165913581848145, 0.7698785066604614, 0.8007104992866516, 0.8233410716056824, 0.8345686793327332, 0.8363668322563171, 0.8336914777755737, 0.8424630761146545, 0.8362352252006531, 0.8404894471168518, 0.8418928980827332)
train_acc_medium = c(0.7592257857322693, 0.7962200045585632, 0.8086076974868774, 0.8167838454246521, 0.8230752348899841, 0.8296525478363037, 0.8334611654281616, 0.8388295769691467, 0.8414163589477539, 0.8435741066932678, 0.8406884074211121, 0.9127659797668457, 0.9410510659217834, 0.9566884636878967, 0.9639286994934082, 0.9701160788536072, 0.9728717803955078, 0.9775643348693848, 0.9800600409507751, 0.9823217988014221)


plot(epochs, val_acc_small, type = 'l', col = 'blue', ylim = c(0.65, 1), ylab = 'accuracy')
lines(epochs, val_acc_medium, col = 'black')
lines(epochs, train_acc_small, col = 'blue', lty = 2)
lines(epochs, train_acc_medium, col = 'black', lty = 2)
abline(v = 10)
legend("bottomright", legend = c('validation accuracy (small)', 'validation accuracy (medium)',
                                 'training accuracy (small)', 'training accuracy (medium'),
       col = c('blue', 'black', 'blue', 'black'),
       lty = c(1, 1, 2, 2))


# loss plot
epochs = c(1:20)
val_loss_small = c(0.5257455706596375, 0.5131644606590271, 0.5548815727233887, 0.5164722800254822, 0.5109460353851318, 0.5136402249336243, 0.5475825071334839, 0.5274254679679871, 0.5143301486968994, 0.5362101793289185, 0.501605212688446, 0.5613815188407898, 0.5359948873519897, 0.611873209476471, 0.6334061622619629, 0.6011473536491394, 0.7044253945350647, 0.7309801578521729, 0.6634897589683533, 0.7068820595741272)
train_loss_small = c(0.43342170119285583, 0.3495695888996124, 0.3209565579891205, 0.3065822422504425, 0.2959986627101898, 0.2894614636898041, 0.2835146486759186, 0.27867746353149414, 0.27591896057128906, 0.27380621433258057, 0.2518242299556732, 0.09798082709312439, 0.06627756357192993, 0.050015248358249664, 0.040973961353302, 0.033409181982278824, 0.0271674245595932, 0.023870298638939857, 0.02073122188448906, 0.017959967255592346)
val_loss_medium = c(0.6033293008804321, 0.6207374930381775, 0.6196607351303101, 0.5999315977096558, 0.642834484577179, 0.6138694882392883, 0.6196521520614624, 0.6603841185569763, 0.6309886574745178, 0.6189635396003723, 0.5899614691734314, 0.6028351783752441, 0.6243982911109924, 0.6711220145225525, 0.7522711157798767, 0.7313758730888367, 0.7953453063964844, 0.8251928091049194, 0.8737655878067017, 0.9028504490852356)
train_loss_medium = c(0.5032098293304443, 0.444638192653656, 0.42049747705459595, 0.4049742817878723, 0.39327511191368103, 0.38223543763160706, 0.37354791164398193, 0.3650512397289276, 0.3613215386867523, 0.35842040181159973, 0.3828062415122986, 0.2263779491186142, 0.15736834704875946, 0.11722183972597122, 0.09974757581949234, 0.08273384720087051, 0.07205372303724289, 0.06259085237979889, 0.05587277188897133, 0.04787244275212288)
plot(epochs, val_loss_small, type = 'l', col = 'blue', ylim = c(0, 1), ylab = 'loss')
lines(epochs, val_loss_medium, col = 'black')
lines(epochs, train_loss_small, col = 'blue', lty = 2)
lines(epochs, train_loss_medium, col = 'black', lty = 2)
abline(v = 10)
legend("topleft", legend = c('validation loss (small)', 'validation loss (medium)',
                                 'training loss (small)', 'training loss (medium'),
       col = c('blue', 'black', 'blue', 'black'),
       lty = c(1, 1, 2, 2))
