library(ggplot2)
epochs20 = c(1:20)
epochs40 = c(1:40)
epochs100 = c(1:100)

#######################################################################################
#                                          SMALL
#######################################################################################

random_weights3_40_epochs_lr_train_loss = c(1.0338572263717651, 0.707123875617981, 0.6198350191116333, 0.5452049970626831, 0.4816950857639313, 0.43955790996551514, 0.4070833921432495, 0.38026702404022217, 0.35901939868927, 0.34065791964530945, 0.3247450888156891, 0.3110997974872589, 0.2981511652469635, 0.2880825996398926, 0.27927055954933167, 0.2707967758178711, 0.26300111413002014, 0.256034255027771, 0.2500503957271576, 0.24461635947227478, 0.2393537312746048, 0.2332593947649002, 0.22851885855197906, 0.2243107557296753, 0.21825754642486572, 0.21611766517162323, 0.21171143651008606, 0.20676571130752563, 0.20314934849739075, 0.1994757205247879, 0.19534260034561157, 0.19096297025680542, 0.18861883878707886, 0.18520770967006683, 0.18289008736610413, 0.18069446086883545, 0.1755702644586563, 0.1733739674091339, 0.1710227131843567, 0.16753873229026794)
random_weights3_40_epochs_lr_train_acc = c(0.5159702897071838, 0.553683876991272, 0.6553859710693359, 0.7251981496810913, 0.7699394226074219, 0.7990278005599976, 0.8200423717498779, 0.8351141214370728, 0.8473842740058899, 0.8566889762878418, 0.8648880124092102, 0.8714120388031006, 0.8776260614395142, 0.8821383714675903, 0.8866237998008728, 0.8905936479568481, 0.8942773938179016, 0.8977853059768677, 0.9004050493240356, 0.9028310775756836, 0.9054210186004639, 0.907692015171051, 0.909587562084198, 0.9119331240653992, 0.9137213230133057, 0.9152025580406189, 0.9169192314147949, 0.9198042750358582, 0.920233428478241, 0.9220395088195801, 0.9235863089561462, 0.9257023930549622, 0.9266233444213867, 0.9276366829872131, 0.9288884401321411, 0.9299404621124268, 0.9317615032196045, 0.9332814812660217, 0.9339222311973572, 0.9354392886161804)
random_weights3_40_epochs_lr_val_loss = c(0.7803536057472229, 0.6582812666893005, 0.5859947204589844, 0.5168266892433167, 0.4712887108325958, 0.45809799432754517, 0.4307750165462494, 0.4102456271648407, 0.39042040705680847, 0.3993583917617798, 0.38968178629875183, 0.38845232129096985, 0.36972206830978394, 0.38289666175842285, 0.3850571811199188, 0.37417012453079224, 0.3742634057998657, 0.3746500611305237, 0.36851873993873596, 0.38694363832473755, 0.38121455907821655, 0.37645718455314636, 0.36147764325141907, 0.3873646557331085, 0.383563369512558, 0.37546634674072266, 0.37544211745262146, 0.39245492219924927, 0.3737480044364929, 0.37993428111076355, 0.39530694484710693, 0.3819514811038971, 0.3722705841064453, 0.3942748010158539, 0.377949982881546, 0.3641427457332611, 0.39973756670951843, 0.3732418119907379, 0.40274375677108765, 0.3996666669845581)
random_weights3_40_epochs_lr_val_acc = c(0.5119301676750183, 0.6023700833320618, 0.6888065934181213, 0.7564542889595032, 0.7858654856681824, 0.7982648611068726, 0.815915584564209, 0.8256494402885437, 0.8350737690925598, 0.8343849182128906, 0.8371703028678894, 0.8369007706642151, 0.8479823470115662, 0.8386378884315491, 0.8403050899505615, 0.8458159565925598, 0.8496296405792236, 0.8444082736968994, 0.8475930094718933, 0.8415130972862244, 0.8444282412528992, 0.8473134636878967, 0.8525248169898987, 0.8413533568382263, 0.843080461025238, 0.8466145992279053, 0.8496895432472229, 0.8447976112365723, 0.8504881858825684, 0.846664547920227, 0.8429606556892395, 0.8465247750282288, 0.8486812114715576, 0.8461753726005554, 0.8486213088035583, 0.8514066934585571, 0.8441187739372253, 0.8536229729652405, 0.8412036299705505, 0.8456262350082397)

IN_weights3_train_loss = c(0.4326206147670746, 0.32716137170791626, 0.2918771207332611, 0.26851633191108704, 0.2544322609901428, 0.2426363080739975, 0.23545880615711212, 0.2284248322248459, 0.22425177693367004, 0.2192186564207077, 0.1025342047214508, 0.04802965000271797, 0.03470393270254135, 0.026861989870667458, 0.022522760555148125, 0.01889026165008545, 0.01609950140118599, 0.014796880073845387, 0.013392151333391666, 0.012092985212802887)
IN_weights3_train_acc = c(0.8043030500411987, 0.8581910729408264, 0.8765590786933899, 0.8880841732025146, 0.8951297998428345, 0.8999490141868591, 0.9036715030670166, 0.9068605303764343, 0.9091583490371704, 0.9112684726715088, 0.9627036452293396, 0.9831162095069885, 0.9881440997123718, 0.9909515976905823, 0.9924179315567017, 0.9937143921852112, 0.9945310354232788, 0.9951390027999878, 0.9957619309425354, 0.9960599541664124)
IN_weights3_val_loss = c(0.548721194267273, 0.5174928903579712, 0.5190073847770691, 0.5172839164733887, 0.5166624784469604, 0.5268561840057373, 0.5551428198814392, 0.5471870303153992, 0.5350000858306885, 0.5421568751335144, 0.3943076729774475, 0.5803886651992798, 0.7488391399383545, 1.1100512742996216, 0.8828000426292419, 0.996871829032898, 0.7106046080589294, 0.9908955097198486, 0.7857121229171753, 1.0255202054977417)
IN_weights3_val_acc = c(0.7289798855781555, 0.7561248540878296, 0.7604576349258423, 0.7697222828865051, 0.7684842944145203, 0.7738354206085205, 0.7667871117591858, 0.771139919757843, 0.7776291370391846, 0.773745596408844, 0.8639358878135681, 0.8638260364532471, 0.8788710832595825, 0.8529341220855713, 0.8639458417892456, 0.8476428985595703, 0.8847912549972534, 0.8663418889045715, 0.8811173439025879, 0.8760856986045837)

IN_finetuned3_train_loss = c(0.4399949908256531, 0.330058753490448, 0.2923583388328552, 0.26887816190719604, 0.25329020619392395, 0.24292024970054626, 0.23470014333724976, 0.22691285610198975, 0.22236979007720947, 0.21900536119937897,0.10715004801750183, 0.05253887549042702, 0.037168096750974655, 0.028712311759591103, 0.02449503354728222, 0.019980421289801598, 0.01683920994400978, 0.014697990380227566, 0.013374383561313152, 0.012326743453741074)
IN_finetuned3_train_acc = c(0.8028039336204529, 0.8569631576538086, 0.8762759566307068, 0.8873659372329712, 0.8946529030799866, 0.900193452835083, 0.9042437672615051, 0.9078261256217957, 0.9096829295158386, 0.911575436592102, 0.9607753753662109, 0.9813578128814697, 0.9871426820755005, 0.9900932312011719, 0.9915447235107422, 0.9930974841117859, 0.994218111038208, 0.9950525760650635, 0.9956933856010437, 0.9960271716117859)
IN_finetuned3_val_loss = c(0.5432246327400208, 0.51133131980896, 0.5199981927871704, 0.5120886564254761, 0.5309845209121704, 0.518580973148346, 0.5445472002029419, 0.5354717373847961, 0.548631489276886, 0.5311091542243958, 0.41716164350509644, 0.7004234194755554, 0.5511797070503235, 0.6593117713928223, 0.5263811945915222, 0.6600003242492676, 0.8195873498916626, 0.6290042400360107, 0.8425958156585693, 0.9596388936042786)
IN_finetuned3_val_acc = c(0.7305672764778137, 0.7574526071548462, 0.7602779269218445, 0.773585855960846, 0.7691432237625122, 0.7728970050811768, 0.7674360275268555, 0.7760417461395264, 0.7726074457168579, 0.7776091694831848, 0.858005702495575, 0.8454066514968872, 0.8667511940002441, 0.8867679834365845, 0.868088960647583, 0.8725216388702393, 0.8598027229309082, 0.8702553510665894, 0.8653734922409058, 0.8560888767242432)

IN_weights3_full_aug_train_loss = c(0.45450374484062195, 0.35539770126342773, 0.32017093896865845, 0.2980089485645294, 0.28341031074523926, 0.2728210687637329, 0.26343491673469543, 0.25691667199134827, 0.25178325176239014, 0.24889864027500153,0.11987712979316711, 0.05889451503753662, 0.04440208151936531, 0.03489457815885544, 0.029077675193548203, 0.025774210691452026, 0.022572776302695274, 0.019944297149777412, 0.018182558938860893, 0.015774307772517204)
IN_weights3_full_aug_train_acc = c(0.7938002347946167, 0.843590259552002, 0.86189866065979, 0.8732479214668274, 0.8808448910713196, 0.8862631916999817, 0.8907158374786377, 0.8938661217689514, 0.8958718776702881, 0.8973084092140198, 0.9557892084121704, 0.9794116020202637, 0.9846898317337036, 0.9877089858055115, 0.9899412393569946, 0.9910946488380432, 0.9922689199447632, 0.993303120136261, 0.9938544631004333, 0.994683027267456)
IN_weights3_full_aug_val_loss = c(0.5613662004470825, 0.5750718116760254, 0.5926896929740906, 0.6195510625839233, 0.6299266815185547, 0.654337465763092, 0.6583850383758545, 0.6667789816856384, 0.6501137614250183, 0.6867047548294067, 1.5986055135726929, 2.079726457595825, 1.440295696258545, 1.8474103212356567, 1.7929803133010864, 1.6228300333023071, 1.574626088142395, 1.8466202020645142, 1.3743515014648438, 1.4559506177902222)
IN_weights3_full_aug_val_acc = c(0.7236686944961548, 0.7312461137771606, 0.7325040698051453, 0.7323243618011475, 0.7345706224441528, 0.729888379573822, 0.7329432964324951, 0.7384042739868164, 0.741499125957489, 0.7313959002494812, 0.7410199046134949, 0.7249266505241394, 0.7325140237808228, 0.7221512198448181, 0.7416688203811646, 0.7856059074401855, 0.7608270049095154, 0.7220513820648193, 0.7742447257041931, 0.7737755179405212)

IN_weights3_no_aug_train_loss = c(0.42403435707092285, 0.3249484598636627, 0.289502888917923, 0.26904693245887756, 0.2531295120716095, 0.24171938002109528, 0.23427310585975647, 0.22578580677509308, 0.22207418084144592, 0.21614991128444672,0.09883806109428406, 0.044792596250772476, 0.02984565868973732, 0.022894835099577904, 0.01776200532913208, 0.014685793779790401, 0.01219606027007103, 0.011861372739076614, 0.00976705364882946, 0.008684313856065273)
IN_weights3_no_aug_train_acc = c(0.8081656098365784, 0.8596664071083069, 0.8781655430793762, 0.8875894546508789, 0.8951655626296997, 0.9005212783813477, 0.9047265648841858, 0.9082493782043457, 0.9100077748298645, 0.9124755263328552, 0.9638063907623291, 0.9845497608184814, 0.9899084568023682, 0.9920811653137207, 0.9938574433326721, 0.9952045679092407, 0.9959079623222351, 0.9962089657783508, 0.9969332218170166, 0.9972848892211914)
IN_weights3_no_aug_val_loss = c(0.5407745838165283, 0.5221121907234192, 0.5091531276702881, 0.5333304405212402, 0.5348759889602661, 0.5366945266723633, 0.5418004989624023, 0.5455340147018433, 0.5294039845466614, 0.5505188703536987, 0.4142511188983917, 0.5255964398384094, 0.5292218923568726, 0.858010470867157, 1.4135851860046387, 0.7056101560592651, 0.6211234331130981, 1.050815224647522, 0.9149937033653259, 0.9839167594909668)
IN_weights3_no_aug_val_acc = c(0.7347103953361511, 0.7543078660964966, 0.7684044241905212, 0.7642912864685059, 0.7672064304351807, 0.7729169726371765, 0.7743445634841919, 0.7753629088401794, 0.7780584096908569, 0.775642454624176, 0.8770440816879272, 0.8749176263809204, 0.8810175061225891, 0.8734999895095825, 0.8439889550209045, 0.8765649199485779, 0.8903420567512512, 0.8585248589515686, 0.8855699300765991, 0.8860491514205933)

############################################### WEIGHTS ###############################################

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs40, y = random_weights3_40_epochs_lr_val_acc)
b = data.frame(x = epochs20, y = IN_weights3_val_acc)
c = data.frame(x = epochs20, y = IN_finetuned3_val_acc)

df = rbind(a,b,c)
df$dataset <- c(rep("Random weights initialization", nrow(a)), 
                rep("Pre-trained", nrow(b)),
                rep("Pre-trained and fine-tuned", nrow(c)))


colours = c("#1F77B4","#FF7F0E", "#2CA02C")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Validation accuracy") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.8, 0.5)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "small_weights_val_acc"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs40, y = random_weights3_40_epochs_lr_train_acc)
b = data.frame(x = epochs20, y = IN_weights3_train_acc)
c = data.frame(x = epochs20, y = IN_finetuned3_train_acc)

df = rbind(a,b,c)
df$dataset <- c(rep("Random weights initialization", nrow(a)), 
                rep("Pre-trained", nrow(b)),
                rep("Pre-trained and fine-tuned", nrow(c)))


colours = c("#1F77B4","#FF7F0E", "#2CA02C")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Training accuracy") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.8, 0.5)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "small_weights_train_acc"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs40, y = random_weights3_40_epochs_lr_val_loss)
b = data.frame(x = epochs20, y = IN_weights3_val_loss)
c = data.frame(x = epochs20, y = IN_finetuned3_val_loss)

df = rbind(a,b,c)
df$dataset <- c(rep("Random weights initialization", nrow(a)), 
                rep("Pre-trained", nrow(b)),
                rep("Pre-trained and fine-tuned", nrow(c)))


colours = c("#1F77B4","#FF7F0E", "#2CA02C")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  #ylim(NA,NA) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Validation loss") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.8, 0.5)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "small_weights_val_loss"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------


a = data.frame(x = epochs40, y = random_weights3_40_epochs_lr_train_loss)
b = data.frame(x = epochs20, y = IN_weights3_train_loss)
c = data.frame(x = epochs20, y = IN_finetuned3_train_loss)

df = rbind(a,b,c)
df$dataset <- c(rep("Random weights initialization", nrow(a)), 
                rep("Pre-trained", nrow(b)),
                rep("Pre-trained and fine-tuned", nrow(c)))


colours = c("#1F77B4","#FF7F0E", "#2CA02C")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  #ylim(NA,NA) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Training loss") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.8, 0.5)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "small_weights_train_loss"
p + ggsave(paste0(name,".png"), type = "cairo")

############################################### AUGMENTATION ############################################### 
#--------------------------------------------------------------------------------------

a = data.frame(x = epochs20, y = IN_weights3_no_aug_val_acc)
b = data.frame(x = epochs20, y = IN_weights3_val_acc)
c = data.frame(x = epochs20, y = IN_weights3_full_aug_val_acc)

df = rbind(a,b,c)
df$dataset <- c(rep("No augmentation", nrow(a)), 
                rep("Mirroring", nrow(b)),
                rep("Mirroring and rotating", nrow(c)))


colours = c("#1F77B4","#D62728", "#FFD700")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Validation accuracy") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.31, 0.8)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "small_augm_val_acc"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs20, y = IN_weights3_no_aug_train_acc)
b = data.frame(x = epochs20, y = IN_weights3_train_acc)
c = data.frame(x = epochs20, y = IN_weights3_full_aug_train_acc)

df = rbind(a,b,c)
df$dataset <- c(rep("No augmentation", nrow(a)), 
                rep("Mirroring", nrow(b)),
                rep("Mirroring and rotating", nrow(c)))


colours = c("#1F77B4","#D62728", "#FFD700")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Training accuracy") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.31, 0.8)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "small_augm_train_acc"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs20, y = IN_weights3_no_aug_val_loss)
b = data.frame(x = epochs20, y = IN_weights3_val_loss)
c = data.frame(x = epochs20, y = IN_weights3_full_aug_val_loss)

df = rbind(a,b,c)
df$dataset <- c(rep("No augmentation", nrow(a)), 
                rep("Mirroring", nrow(b)),
                rep("Mirroring and rotating", nrow(c)))


colours = c("#1F77B4","#D62728", "#FFD700")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  #ylim(NA,NA) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Validation loss") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.31, 0.8)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "small_augm_val_loss"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------


a = data.frame(x = epochs20, y = IN_weights3_no_aug_train_loss)
b = data.frame(x = epochs20, y = IN_weights3_train_loss)
c = data.frame(x = epochs20, y = IN_weights3_full_aug_train_loss)

df = rbind(a,b,c)
df$dataset <- c(rep("No augmentation", nrow(a)), 
                rep("Mirroring", nrow(b)),
                rep("Mirroring and rotating", nrow(c)))

colours = c("#1F77B4","#D62728", "#FFD700")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  #ylim(NA,NA) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Training loss") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.31, 0.8)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "small_augm_train_loss"
p + ggsave(paste0(name,".png"), type = "cairo")


#######################################################################################
#                                          MEDIUM
#######################################################################################


random_weights3_100_epochs_lr_train_loss = c(1.167518138885498, 0.9674254655838013, 0.8432123064994812, 0.7789381146430969, 0.745057225227356, 0.724380373954773, 0.7106143832206726, 0.701910138130188, 0.6982944011688232, 0.6928257346153259, 0.6907777190208435, 0.6865245699882507, 0.6831492185592651, 0.6781269907951355, 0.6683182120323181, 0.6606478691101074, 0.6471902132034302, 0.6318398118019104, 0.6130138039588928, 0.5993279218673706, 0.5864402055740356, 0.5745250582695007, 0.5643336772918701, 0.5545362234115601, 0.5478476881980896, 0.5368070006370544, 0.5308391451835632, 0.5185658931732178, 0.509194016456604, 0.5001972913742065, 0.4922584295272827, 0.484555721282959, 0.47541069984436035, 0.46739113330841064, 0.4628719091415405, 0.45509329438209534, 0.4473528265953064, 0.442048579454422, 0.43545132875442505, 0.4311089813709259, 0.4258820116519928, 0.41826584935188293, 0.4137163460254669, 0.4075414538383484, 0.400066077709198, 0.39849036931991577, 0.39549922943115234, 0.3903939127922058, 0.3857031464576721, 0.385515958070755, 0.37973299622535706, 0.3757217228412628, 0.37291067838668823, 0.36948809027671814, 0.3638465702533722, 0.3595564663410187, 0.3575901985168457, 0.3564722239971161, 0.35323238372802734, 0.3512280285358429, 0.3488544523715973, 0.3433389663696289, 0.34277960658073425, 0.3378833532333374, 0.33633261919021606, 0.3351883292198181, 0.330640584230423, 0.3281879127025604, 0.3283695876598358, 0.3216266632080078, 0.32100242376327515, 0.3229195475578308, 0.3160974681377411, 0.3135337829589844, 0.31345537304878235, 0.31155523657798767, 0.30758583545684814, 0.30524417757987976, 0.30369871854782104, 0.300775408744812, 0.3023066520690918, 0.30064278841018677, 0.2977142632007599, 0.294106125831604, 0.29263412952423096, 0.29190176725387573, 0.2884851396083832, 0.28867214918136597, 0.28654998540878296, 0.2831096649169922, 0.2846124470233917, 0.2840094268321991, 0.28159305453300476, 0.2824246883392334, 0.2783549129962921, 0.27467110753059387, 0.276749849319458, 0.2737594246864319, 0.272275447845459, 0.271869957447052)
random_weights3_100_epochs_lr_train_acc = c(0.5142660140991211, 0.5147989988327026, 0.519660472869873, 0.5221042037010193, 0.5216492414474487, 0.5238720178604126, 0.528824508190155, 0.533504068851471, 0.5344399809837341, 0.538937509059906, 0.5421481728553772, 0.5475295782089233, 0.5498953461647034, 0.5568366646766663, 0.5662606954574585, 0.5825480222702026, 0.6091042757034302, 0.6380522847175598, 0.662749707698822, 0.6768922805786133, 0.6896569728851318, 0.6999129056930542, 0.7094539403915405, 0.7184360027313232, 0.7222576141357422, 0.7322795987129211, 0.7401827573776245, 0.7483848929405212, 0.7542603015899658, 0.7621505260467529, 0.7669860124588013, 0.7724454402923584, 0.7789577841758728, 0.7833383083343506, 0.7872248888015747, 0.7913714647293091, 0.7969089150428772, 0.8002625703811646, 0.8046691417694092, 0.8080227971076965, 0.8097646236419678, 0.8153150081634521, 0.8161209225654602, 0.8211254477500916, 0.8232961893081665, 0.825986921787262, 0.8254929780960083, 0.8294055461883545, 0.8324862718582153, 0.8325122594833374, 0.8364118337631226, 0.838387668132782, 0.8393235206604004, 0.840649425983429, 0.8432231545448303, 0.8456798791885376, 0.846875786781311, 0.8481236696243286, 0.8497225046157837, 0.852192223072052, 0.8529981374740601, 0.8540250062942505, 0.8546879887580872, 0.8582496047019958, 0.8584575653076172, 0.8593025207519531, 0.8598094582557678, 0.8619022369384766, 0.8617982268333435, 0.865385890007019, 0.8654768466949463, 0.864410936832428, 0.8673356771469116, 0.8689734935760498, 0.869831383228302, 0.8707802891731262, 0.871404230594635, 0.8733020424842834, 0.8741339445114136, 0.8766816854476929, 0.8749788999557495, 0.8762007355690002, 0.8774226307868958, 0.877617597579956, 0.8792424201965332, 0.8789434432983398, 0.8801393508911133, 0.8816341757774353, 0.8809972405433655, 0.8833630084991455, 0.8830380439758301, 0.881530225276947, 0.8834019899368286, 0.885182797908783, 0.8865866661071777, 0.8881205320358276, 0.8867296576499939, 0.8880425095558167, 0.8887834548950195, 0.8892773985862732)
random_weights3_100_epochs_lr_val_loss = c(1.0507497787475586, 0.8865647315979004, 0.8014802932739258, 0.7546601295471191, 0.7276185154914856, 0.7174042463302612, 0.7126518487930298, 0.7042644619941711, 0.7023706436157227, 0.6978281140327454, 0.6951480507850647, 0.6945679187774658, 0.6925476789474487, 0.6929514408111572, 0.6954159736633301, 0.6959678530693054, 0.691896915435791, 0.6694541573524475, 0.64241623878479, 0.621942400932312, 0.618675947189331, 0.6340851187705994, 0.5962837934494019, 0.5872527956962585, 0.5856096744537354, 0.5952014327049255, 0.5772297978401184, 0.5620161294937134, 0.5729007720947266, 0.5570701360702515, 0.5602603554725647, 0.5400275588035583, 0.5452613234519958, 0.544969916343689, 0.5384942889213562, 0.5279108881950378, 0.5338639616966248, 0.5287816524505615, 0.5299795269966125, 0.5113115310668945, 0.5154294967651367, 0.5163742303848267, 0.5147567391395569, 0.4972345530986786, 0.5039550065994263, 0.49289247393608093, 0.4882095158100128, 0.4884309470653534, 0.4908492863178253, 0.47859713435173035, 0.4984411597251892, 0.48871010541915894, 0.47199898958206177, 0.4648236334323883, 0.4702606201171875, 0.4768372178077698, 0.4651673436164856, 0.5047088265419006, 0.4702705442905426, 0.4656555950641632, 0.45017632842063904, 0.4667198956012726, 0.4467475414276123, 0.44499334692955017, 0.44636520743370056, 0.457054078578949, 0.45735201239585876, 0.4544762670993805, 0.4361840486526489, 0.46939194202423096, 0.4417862892150879, 0.4400377869606018, 0.44636547565460205, 0.4619670808315277, 0.4597049355506897, 0.44900867342948914, 0.442415714263916, 0.441590279340744, 0.432387113571167, 0.4572201669216156, 0.4369027316570282, 0.43297499418258667, 0.43259522318840027, 0.4404585659503937, 0.4372268319129944, 0.44184890389442444, 0.43370258808135986, 0.44067656993865967, 0.44846516847610474, 0.444641649723053, 0.43215787410736084, 0.4310126006603241, 0.44310158491134644, 0.4209461212158203, 0.4380916655063629, 0.4313441216945648, 0.43407803773880005, 0.4466150403022766, 0.4239232540130615, 0.4320544898509979)
random_weights3_100_epochs_lr_val_acc = c(0.5035744309425354, 0.5105039477348328, 0.5129599571228027, 0.5151528716087341, 0.5210297703742981, 0.5174334645271301, 0.5173895955085754, 0.5248454213142395, 0.5192316174507141, 0.5263804197311401, 0.5285294651985168, 0.5274768471717834, 0.5380465984344482, 0.5371693968772888, 0.5400201678276062, 0.5490109920501709, 0.5508968830108643, 0.5992719531059265, 0.6346651315689087, 0.6633480787277222, 0.6777772903442383, 0.6657602787017822, 0.7039164900779724, 0.7077321410179138, 0.7105389833450317, 0.7087408304214478, 0.7197929620742798, 0.7332572937011719, 0.7287399768829346, 0.7352747917175293, 0.7395289540290833, 0.7514582872390747, 0.7474672198295593, 0.7474233508110046, 0.7568966150283813, 0.7593088150024414, 0.7534757256507874, 0.7611069679260254, 0.7579492330551147, 0.7684750556945801, 0.7702293992042542, 0.7712819576263428, 0.7681680917739868, 0.7836936712265015, 0.7728169560432434, 0.7811499238014221, 0.7838252782821655, 0.7901846170425415, 0.7877724766731262, 0.7949651479721069, 0.7803166508674622, 0.7868953347206116, 0.7940880060195923, 0.8015876412391663, 0.8007543683052063, 0.7912372350692749, 0.8021578192710876, 0.7817639708518982, 0.8039998412132263, 0.800315797328949, 0.8062804341316223, 0.8023332357406616, 0.8161484003067017, 0.8137362599372864, 0.8160607218742371, 0.808604896068573, 0.8122450709342957, 0.810710072517395, 0.8160607218742371, 0.8039998412132263, 0.813166081905365, 0.8196131587028503, 0.8147010803222656, 0.807464599609375, 0.8091312050819397, 0.8127713799476624, 0.815095841884613, 0.8210166096687317, 0.8207534551620483, 0.8083417415618896, 0.8218499422073364, 0.8225516676902771, 0.819481611251831, 0.816893994808197, 0.8243936896324158, 0.819481611251831, 0.8243059515953064, 0.8218499422073364, 0.8157975673675537, 0.8185606002807617, 0.821279764175415, 0.8252269625663757, 0.8186482787132263, 0.8281216025352478, 0.8205341696739197, 0.8241744041442871, 0.824218213558197, 0.8187798857688904, 0.827946126461029, 0.8268935680389404)

IN_weights3_2_train_loss = c(0.5471885204315186, 0.4295073449611664, 0.40274369716644287, 0.380250483751297, 0.36433473229408264, 0.3535217344760895, 0.339871883392334, 0.3322901725769043, 0.32400038838386536, 0.31698402762413025, 0.19723618030548096, 0.10450863838195801, 0.07450634986162186, 0.06053923815488815, 0.044793933629989624, 0.039732351899147034, 0.03217572346329689, 0.03257351368665695, 0.026043323799967766, 0.02552780695259571)
IN_weights3_2_train_acc = c(0.7469810843467712, 0.8052540421485901, 0.8177847862243652, 0.830718457698822, 0.8393495678901672, 0.8453679084777832, 0.851386308670044, 0.8553898930549622, 0.8585355877876282, 0.8646969199180603, 0.9217220544815063, 0.9609390497207642, 0.9735737442970276, 0.9784612059593201, 0.9840116500854492, 0.9857015013694763, 0.9886651635169983, 0.9885481595993042, 0.9906279444694519, 0.9911869168281555)
IN_weights3_2_val_loss = c(0.6045633554458618, 0.597363293170929, 0.5849835276603699, 0.5923405885696411, 0.6066590547561646, 0.6058993339538574, 0.6111178994178772, 0.6065622568130493, 0.6236733198165894, 0.6125150322914124, 0.5876625180244446, 0.5946140885353088, 0.8160483837127686, 0.7406114339828491, 0.8056255578994751, 0.7986067533493042, 0.8978627324104309, 1.0123860836029053, 1.3134756088256836, 0.8798909187316895)
IN_weights3_2_val_acc = c(0.6907591819763184, 0.6943116784095764, 0.7114599943161011, 0.7097057104110718, 0.7093986868858337, 0.7189158201217651, 0.7186088562011719, 0.7245296239852905, 0.7223367691040039, 0.7306258678436279, 0.8175957202911377, 0.814437985420227, 0.8043506741523743, 0.8284285664558411, 0.8317617774009705, 0.819481611251831, 0.8219814896583557, 0.8278145790100098, 0.7900969386100769, 0.8330774903297424)

IN_finetuned3_train_loss = c(0.5663707852363586, 0.4385581314563751, 0.40649381279945374, 0.38551342487335205, 0.36819666624069214, 0.35437193512916565, 0.3457604944705963, 0.33674100041389465, 0.3268844485282898, 0.31938719749450684,0.20220328867435455, 0.11045964062213898, 0.07661938667297363, 0.05961184576153755, 0.04973466321825981, 0.04200081154704094, 0.03500286489725113, 0.03031407669186592, 0.02918044477701187, 0.025364279747009277)
IN_finetuned3_train_acc = c(0.7383759617805481, 0.7996126413345337, 0.8173428177833557, 0.826870858669281, 0.8355149626731873, 0.8443800210952759, 0.8478506803512573, 0.8531801104545593, 0.8582106232643127, 0.8616812229156494, 0.9196422696113586, 0.9587552547454834, 0.9718059301376343, 0.9781882762908936, 0.9822958111763, 0.9849215745925903, 0.9878592491149902, 0.9890811443328857, 0.989978015422821, 0.9911479353904724)
IN_finetuned3_val_loss = c(0.6100311875343323, 0.6082452535629272, 0.6095612049102783, 0.6020448207855225, 0.6027235388755798, 0.6114697456359863, 0.6133409738540649, 0.6134490370750427, 0.617865264415741, 0.6255512237548828, 0.6923103332519531, 0.715449333190918, 0.7687128782272339, 0.8672672510147095, 0.7739640474319458, 0.8366837501525879, 1.1068001985549927, 1.2903249263763428, 1.1994026899337769, 1.0626310110092163)
IN_finetuned3_val_acc = c(0.6847506761550903, 0.687075138092041, 0.691636323928833, 0.7029516100883484, 0.7122494578361511, 0.7083022594451904, 0.7143546342849731, 0.7240910530090332, 0.7200561165809631, 0.7204070091247559, 0.8061488270759583, 0.811192512512207, 0.8239112496376038, 0.7949212789535522, 0.7900969386100769, 0.808955729007721, 0.8025086522102356, 0.7767641544342041, 0.810096025466919, 0.8034735321998596)

IN_weights3_no_aug_train_loss = c(0.5652459859848022, 0.43770045042037964, 0.4053598642349243, 0.3850734531879425, 0.3689996302127838, 0.35664716362953186, 0.34448951482772827, 0.3367369472980499, 0.3268508315086365, 0.3154589831829071, 0.1923861801624298, 0.09715381264686584, 0.06355168670415878, 0.04736406356096268, 0.03386314585804939, 0.029752468690276146, 0.02669638767838478, 0.020607713609933853, 0.018873877823352814, 0.016339262947440147)
IN_weights3_no_aug_train_acc = c(0.7404167652130127, 0.7989627122879028, 0.8167838454246521, 0.8275467753410339, 0.8354889154434204, 0.842950165271759, 0.8511523604393005, 0.8525041937828064, 0.858288586139679, 0.8632020950317383, 0.9242957830429077, 0.9635257720947266, 0.9773303270339966, 0.9827507734298706, 0.9879112243652344, 0.9890031218528748, 0.990731954574585, 0.993097722530365, 0.9939686059951782, 0.9948005080223083)
IN_weights3_no_aug_val_loss = c(0.6079469919204712, 0.5999867916107178, 0.6002740859985352, 0.5963962078094482, 0.5911054015159607, 0.597100019454956, 0.6056220531463623, 0.5971569418907166, 0.603605329990387, 0.6346223950386047, 0.5925942063331604, 0.6297466158866882, 0.7770851254463196, 0.7260748147964478, 0.8030030131340027, 1.0733017921447754, 0.8061056137084961, 1.050463318824768, 1.1098568439483643, 1.132150650024414)
IN_weights3_no_aug_val_acc = c(0.685276985168457, 0.6884347200393677, 0.694223940372467, 0.7052760720252991, 0.7147932052612305, 0.7130389213562012, 0.7176001071929932, 0.7221612930297852, 0.7232139110565186, 0.7173369526863098, 0.8170255422592163, 0.8222885131835938, 0.8306653499603271, 0.8519801497459412, 0.8352265357971191, 0.809438169002533, 0.8504012823104858, 0.8174203038215637, 0.8433402180671692, 0.812859058380127)

IN_weights3_full_aug_train_loss = c(0.5618491768836975, 0.44226863980293274, 0.41248542070388794, 0.3982132077217102, 0.38114041090011597, 0.37084656953811646, 0.3630744218826294, 0.351397305727005, 0.3471224904060364, 0.34081172943115234, 0.21428219974040985, 0.12064911425113678, 0.08666551113128662, 0.07164710760116577, 0.061108119785785675, 0.05222737044095993, 0.04654660448431969, 0.04071301221847534, 0.04784685745835304, 0.03319830074906349)
IN_weights3_full_aug_train_acc = c(0.7385319471359253, 0.7985207438468933, 0.8144571185112, 0.821372389793396, 0.8308224081993103, 0.8369578123092651, 0.8407533764839172, 0.8454199433326721, 0.8483186364173889, 0.8512693047523499, 0.9144298434257507, 0.9550636410713196, 0.9684522747993469, 0.9741326570510864, 0.9782012701034546, 0.9814639091491699, 0.9833227396011353, 0.9855064749717712, 0.9827377796173096, 0.9880542159080505)
IN_weights3_full_aug_val_loss = c(0.6086034774780273, 0.597732424736023, 0.6068068146705627, 0.6474710702896118, 0.6369950175285339, 0.6417868137359619, 0.6499466300010681, 0.6678045392036438, 0.6618420481681824, 0.6728288531303406, 0.8516673445701599, 0.947214663028717, 1.094996690750122, 1.0677800178527832, 1.3295599222183228, 1.099159836769104, 1.554880976676941, 1.4408525228500366, 1.6306451559066772, 1.5371882915496826)
IN_weights3_full_aug_val_acc = c(0.685627818107605, 0.6991798877716064, 0.6980834007263184, 0.6857155561447144, 0.696504533290863, 0.6962413787841797, 0.7009780406951904, 0.7027323246002197, 0.7073373794555664, 0.7032586336135864, 0.742642879486084, 0.747511088848114, 0.7374676465988159, 0.7668084502220154, 0.752379298210144, 0.7570720314979553, 0.7162405252456665, 0.750142514705658, 0.7310205698013306, 0.7427305579185486)

############################################### WEIGHTS ###############################################

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs100, y = random_weights3_100_epochs_lr_val_acc)
b = data.frame(x = epochs20, y = IN_weights3_2_val_acc)
c = data.frame(x = epochs20, y = IN_finetuned3_val_acc)

df = rbind(a,b,c)
df$dataset <- c(rep("Random weights initialization", nrow(a)), 
                rep("Pre-trained", nrow(b)),
                rep("Pre-trained and fine-tuned", nrow(c)))


colours = c("#1F77B4","#FF7F0E", "#2CA02C")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Validation accuracy") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.8, 0.5)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "medium_weights_val_acc"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs100, y = random_weights3_100_epochs_lr_train_acc)
b = data.frame(x = epochs20, y = IN_weights3_2_train_acc)
c = data.frame(x = epochs20, y = IN_finetuned3_train_acc)

df = rbind(a,b,c)
df$dataset <- c(rep("Random weights initialization", nrow(a)), 
                rep("Pre-trained", nrow(b)),
                rep("Pre-trained and fine-tuned", nrow(c)))


colours = c("#1F77B4","#FF7F0E", "#2CA02C")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Training accuracy") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.8, 0.5)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "medium_weights_train_acc"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs100, y = random_weights3_100_epochs_lr_val_loss)
b = data.frame(x = epochs20, y = IN_weights3_2_val_loss)
c = data.frame(x = epochs20, y = IN_finetuned3_val_loss)

df = rbind(a,b,c)
df$dataset <- c(rep("Random weights initialization", nrow(a)), 
                rep("Pre-trained", nrow(b)),
                rep("Pre-trained and fine-tuned", nrow(c)))


colours = c("#1F77B4","#FF7F0E", "#2CA02C")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  #ylim(NA,NA) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Validation loss") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.8, 0.5)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "medium_weights_val_loss"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------


a = data.frame(x = epochs100, y = random_weights3_100_epochs_lr_train_loss)
b = data.frame(x = epochs20, y = IN_weights3_2_train_loss)
c = data.frame(x = epochs20, y = IN_finetuned3_train_loss)

df = rbind(a,b,c)
df$dataset <- c(rep("Random weights initialization", nrow(a)), 
                rep("Pre-trained", nrow(b)),
                rep("Pre-trained and fine-tuned", nrow(c)))


colours = c("#1F77B4","#FF7F0E", "#2CA02C")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  #ylim(NA,NA) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Training loss") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.8, 0.5)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "medium_weights_train_loss"
p + ggsave(paste0(name,".png"), type = "cairo")

############################################### AUGMENTATION ############################################### 
#--------------------------------------------------------------------------------------

a = data.frame(x = epochs20, y = IN_weights3_no_aug_val_acc)
b = data.frame(x = epochs20, y = IN_weights3_2_val_acc)
c = data.frame(x = epochs20, y = IN_weights3_full_aug_val_acc)

df = rbind(a,b,c)
df$dataset <- c(rep("No augmentation", nrow(a)), 
                rep("Mirroring", nrow(b)),
                rep("Mirroring and rotating", nrow(c)))


colours = c("#1F77B4","#D62728", "#FFD700")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Validation accuracy") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.31, 0.8)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "medium_augm_val_acc"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs20, y = IN_weights3_no_aug_train_acc)
b = data.frame(x = epochs20, y = IN_weights3_2_train_acc)
c = data.frame(x = epochs20, y = IN_weights3_full_aug_train_acc)

df = rbind(a,b,c)
df$dataset <- c(rep("No augmentation", nrow(a)), 
                rep("Mirroring", nrow(b)),
                rep("Mirroring and rotating", nrow(c)))


colours = c("#1F77B4","#D62728", "#FFD700")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Training accuracy") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.31, 0.8)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "medium_augm_train_acc"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------

a = data.frame(x = epochs20, y = IN_weights3_no_aug_val_loss)
b = data.frame(x = epochs20, y = IN_weights3_2_val_loss)
c = data.frame(x = epochs20, y = IN_weights3_full_aug_val_loss)

df = rbind(a,b,c)
df$dataset <- c(rep("No augmentation", nrow(a)), 
                rep("Mirroring", nrow(b)),
                rep("Mirroring and rotating", nrow(c)))


colours = c("#1F77B4","#D62728", "#FFD700")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  #ylim(NA,1) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Validation loss") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.31, 0.8)) +
  theme(axis.title=element_text(size=17)) + 
  theme(legend.position='none')
p
name = "medium_augm_val_loss"
p + ggsave(paste0(name,".png"), type = "cairo")

#--------------------------------------------------------------------------------------


a = data.frame(x = epochs20, y = IN_weights3_no_aug_train_loss)
b = data.frame(x = epochs20, y = IN_weights3_2_train_loss)
c = data.frame(x = epochs20, y = IN_weights3_full_aug_train_loss)

df = rbind(a,b,c)
df$dataset <- c(rep("No augmentation", nrow(a)), 
                rep("Mirroring", nrow(b)),
                rep("Mirroring and rotating", nrow(c)))

colours = c("#1F77B4","#D62728", "#FFD700")
p = ggplot(data = df, aes(x = x, y = y, col=dataset)) +
  #ylim(NA,NA) +
  geom_line(size = 1) + 
  #scale_color_brewer(palette="Set1") + 
  scale_color_manual(values = colours) + 
  xlab("Epochs") + ylab("Training loss") + 
  theme(legend.title = element_blank()) +
  theme(legend.position = c(0.31, 0.8)) +
  theme(axis.title=element_text(size=17))  + 
  theme(legend.position='none')
p
name = "medium_augm_train_loss"
p + ggsave(paste0(name,".png"), type = "cairo")

